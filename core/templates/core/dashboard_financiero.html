<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard Financiero</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f4f6f9; }
        .card-box { border-radius: 10px; border: none; color: white; }
        .bg-gradient-primary { background: linear-gradient(45deg, #4e73df, #224abe); }
        .bg-gradient-success { background: linear-gradient(45deg, #1cc88a, #13855c); }
        .bg-gradient-info { background: linear-gradient(45deg, #36b9cc, #258391); }
        .bg-gradient-warning { background: linear-gradient(45deg, #f6c23e, #dda20a); }
    </style>
</head>
<body class="p-4">

    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h3 text-gray-800">ğŸ“Š Reporte Financiero & EstadÃ­sticas</h1>
            <a href="{% url 'panel_administracion' %}" class="btn btn-secondary">â† Volver al Admin</a>
        </div>

        <div class="row mb-4">
            
            <div class="col-md-3 mb-4">
                <div class="card card-box bg-gradient-success h-100 py-2">
                    <div class="card-body">
                        <div class="text-uppercase small fw-bold mb-1">Ventas Totales (HistÃ³rico)</div>
                        <div class="h3 mb-0 fw-bold">${{ dinero_total }}</div>
                        <div class="small mt-2">ğŸ’° Dinero total movido</div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-4">
                <div class="card card-box bg-gradient-primary h-100 py-2">
                    <div class="card-body">
                        <div class="text-uppercase small fw-bold mb-1">Ventas de {{ mes_actual }}</div>
                        <div class="h3 mb-0 fw-bold">${{ dinero_mes }}</div>
                        <div class="small mt-2">ğŸ“… Reuniones este mes: <b>{{ cantidad_mes }}</b></div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-4">
                <div class="card card-box bg-gradient-info h-100 py-2">
                    <div class="card-body">
                        <div class="text-uppercase small fw-bold mb-1">Tu Ganancia (10%)</div>
                        <div class="h3 mb-0 fw-bold">${{ ganancia_plataforma }}</div>
                        <div class="small mt-2">ğŸ¢ Ingreso neto para la empresa</div>
                    </div>
                </div>
            </div>

            <div class="col-md-3 mb-4">
                <div class="card card-box bg-gradient-warning h-100 py-2">
                    <div class="card-body">
                        <div class="text-uppercase small fw-bold mb-1">Citas Concretadas</div>
                        <div class="h3 mb-0 fw-bold">{{ cantidad_total }}</div>
                        <div class="small mt-2">âœ… Total de reuniones exitosas</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card shadow mb-4">
            <div class="card-header py-3 bg-white">
                <h6 class="m-0 fw-bold text-primary">ğŸ† Top Asesores (Ranking de Ventas)</h6>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-hover" width="100%" cellspacing="0">
                        <thead class="table-light">
                            <tr>
                                <th>#</th>
                                <th>Asesor</th>
                                <th>TÃ­tulo</th>
                                <th>Precio Hora</th>
                                <th class="text-center">Ventas Confirmadas</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for asesor in top_asesores %}
                            <tr>
                                <td>{{ forloop.counter }}</td>
                                <td class="fw-bold">{{ asesor.user.first_name }} {{ asesor.user.last_name }}</td>
                                <td>{{ asesor.public_title }}</td>
                                <td>${{ asesor.hourly_rate }}</td>
                                <td class="text-center">
                                    <span class="badge bg-success rounded-pill px-3">{{ asesor.total_ventas }}</span>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center text-muted">AÃºn no hay ventas registradas.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

</body>
</html>